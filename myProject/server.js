//  
//  hyunilPark
//  leehan2121@gmail.com
const express = require('express');
const cors = require('cors');
const path = require('path');

const app = express();

/*
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ê¸°ë³¸ ë¯¸ë“¤ì›¨ì–´
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
*/

// CORS í—ˆìš©
// í”„ë¡ íŠ¸(React)ê°€ ë‹¤ë¥¸ í¬íŠ¸/ë„ë©”ì¸ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•˜ê²Œ í•¨
app.use(cors());

// JSON ìš”ì²­ íŒŒì‹±
// req.body ì‚¬ìš© ê°€ëŠ¥
app.use(express.json());

/*
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ì •ì  íŒŒì¼ ê³µê°œ (ðŸ”¥ ì¤‘ìš” ðŸ”¥)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
*/

// uploads í´ë”ë¥¼ URLë¡œ ì ‘ê·¼ ê°€ëŠ¥í•˜ê²Œ ì„¤ì •
// http://ì„œë²„ì£¼ì†Œ:í¬íŠ¸/uploads/íŒŒì¼ëª…
app.use('/uploads', express.static(path.join(__dirname, 'uploads')));

/*
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ë¼ìš°í„° ì—°ê²°
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
*/

const routes = require('./routes');

// ëª¨ë“  APIëŠ” /api ë¡œ ì‹œìž‘
// ì˜ˆ: POST /api/upload
app.use('/api', routes);

/*
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ê¸°ë³¸ ë£¨íŠ¸
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
*/

// ì„œë²„ ì‚´ì•„ìžˆëŠ”ì§€ í™•ì¸ìš©
app.get('/', (req, res) => {
  res.send('âœ… Server is running');
});

/*
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ì„œë²„ ì‹¤í–‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
*/

const PORT = 3000;
const HOST = '0.0.0.0'; // ë‚´ë¶€ IP ì ‘ê·¼ í—ˆìš©

app.listen(PORT, HOST, () => {
  console.log(`ðŸš€ Server running`);
  console.log(`ðŸ‘‰ Local    : http://localhost:${PORT}`);
  console.log(`ðŸ‘‰ Network  : http://192.168.0.57:${PORT}`);
});